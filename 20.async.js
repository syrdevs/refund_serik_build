(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"+/uU":function(e,t,a){e.exports={modal_buttons:"antd-pro\\pages\\-calendar\\-calendar-view-modal_buttons",customCalendar:"antd-pro\\pages\\-calendar\\-calendar-view-customCalendar"}},8873:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var d=l(a("bx4M"));a("T2oS");var r=l(a("W9HT"));a("qbNl");var o=l(a("JBPa"));a("2qtc");var i=l(a("kLXV"));a("5NDa");var s=l(a("5rEg")),c=l(a("MVZn"));a("+L6B");var u=l(a("2/Rp"));a("Pwec");var f=l(a("CtXQ")),m=l(a("lwsE")),p=l(a("W8MJ")),v=l(a("a1gu")),h=l(a("Nsbk")),D=l(a("7W2i"));a("OaEy");var Y=l(a("2fM7"));a("iQDF");var y,M,g=l(a("+eQT")),b=n(a("q1tI")),E=a("MuoO"),k=a("LLXN"),C=l(a("zHco")),w=l(a("+/uU")),V=l(a("wd/R"));l(a("zTng")),l(a("KkEE"));V.default.locale("ru-ru");var S=g.default.MonthPicker,F=(g.default.RangePicker,g.default.WeekPicker,Y.default.Option),T=(y=(0,E.connect)(function(e){var t=e.calendar,a=e.loading;return{calendar:t,loadingData:a.effects["calendar/get"]}}),y(M=function(e){function t(e){var a;return(0,m.default)(this,t),a=(0,v.default)(this,(0,h.default)(t).call(this,e)),a.showModal=function(e){var t=a.state.modalForm;Object.keys(e).length&&(t.eventDescriptionVisible="2"===e.EventID.id.id,t.deleteBtnVisible=!0,t.description=e.EventID.name,t.selectedDayType=e.EventID.id.id),a.setState({modalVisible:!0,modalData:e||{},modalForm:t})},a.handleOk=function(e){var t=a.state,l=t.modalForm,n=(t.modalData,t.selectedDate),d=a.props.dispatch;d({type:"calendar/save",payload:{eventTitle:l.description,eventDate:(0,V.default)(n,"DD-MM-YYYY").format("DD.MM.YYYY"),deventId:{id:l.selectedDayType}}}).then(function(){d({type:"calendar/get",payload:{monthYear:(0,V.default)(n,"DD-MM-YYYY").format("MM.YYYY")}})}),a.handleCancel()},a.handleCancel=function(e){a.setState({modalData:{},modalVisible:!1,modalForm:{selectedDay:"",description:"",deleteBtnVisible:!1,eventDescriptionVisible:!1}})},a.handleDelete=function(){var e=a.state,t=e.modalData,l=e.selectedDate,n=a.props.dispatch;Object.keys(t).length>0&&(n({type:"calendar/remove",payload:{id:t.id}}).then(function(){n({type:"calendar/get",payload:{monthYear:(0,V.default)(l,"DD-MM-YYYY").format("MM.YYYY")}})}),a.handleCancel())},a.state={currentDate:(0,V.default)(),modalVisible:!1,selectedDate:"",modalData:{},dataSource:[],modalForm:{selectedDayType:"",description:"",deleteBtnVisible:!1,eventDescriptionVisible:!1}},a}return(0,D.default)(t,e),(0,p.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"calendar/get",payload:{monthYear:(0,V.default)(new Date,"DD-MM-YYYY").format("MM.YYYY")}}),this.setState({dataSource:[{date:"23.10.2018",EventID:{id:"1"}},{date:"01.10.2018",EventID:{id:"2",name:"Lorem ipsum dolor sit amet 11111"}}]})}},{key:"dateCellRender",value:function(e){var t=this.getListData(e);return t&&b.default.createElement("div",{className:"event_day"},b.default.createElement(f.default,{type:"calendar",theme:"outlined"}),t.EventID.name)}},{key:"getListData",value:function(e){var t;if(this.props.calendar.events.length>0){var a=this.props.calendar.events;a.forEach(function(a){var l=(0,V.default)(a.date,"DD-MM-YYYY").format("DD"),n=(0,V.default)(a.date,"DD-MM-YYYY").format("MM");l==e.date()&&n==e.month()+1&&(t=a)})}return t||""}},{key:"onSelectDate",value:function(e){var t=(0,V.default)(e,"DD.MM.YYYY");this.setState({selectedDate:t});var a=this.getListData(e);this.showModal(a)}},{key:"onChangeDatePicker",value:function(e,t){var a=this.props.dispatch;a({type:"calendar/get",payload:{monthYear:t}});(0,V.default)(e).format("MM"),(0,V.default)(e).format("YYYY");e&&this.setState({currentDate:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.modalVisible,l=t.currentDate,n=t.modalForm,f=n.eventDescriptionVisible,m=n.deleteBtnVisible,p={fontSize:"13px",fontWeight:"bold"};return b.default.createElement(C.default,{title:(0,k.formatMessage)({id:"menu.refunds.calendar"})},b.default.createElement(i.default,{centered:!0,className:w.default.modal_buttons,title:(0,k.formatMessage)({id:"calendar.createEvent"})+" "+(0,V.default)(this.state.selectedDate).format("DD.MM.YYYY"),onCancel:this.handleCancel.bind(this),visible:a,footer:[b.default.createElement(u.default,{style:{display:m?"":"none"},key:"delete",onClick:this.handleDelete,type:"danger"},(0,k.formatMessage)({id:"button.delete"})),b.default.createElement(u.default,{key:"submit",onClick:this.handleOk,type:"primary"},(0,k.formatMessage)({id:"form.save"})),b.default.createElement(u.default,{key:"cancel",onClick:this.handleCancel},(0,k.formatMessage)({id:"button.cancel"}))]},b.default.createElement("div",null,b.default.createElement("span",{style:p},(0,k.formatMessage)({id:"label.type"}),":"),b.default.createElement(Y.default,{style:{width:"100%"},placeholder:(0,k.formatMessage)({id:"label.select"}),value:n.selectedDayType,onChange:function(t,a){e.setState(function(e){var a=e.modalForm;return{modalForm:(0,c.default)({},a,{selectedDayType:t,description:"",eventDescriptionVisible:"2"===t})}})},optionFilterProp:"children"},b.default.createElement(F,{value:"1"},"\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439 \u0434\u0435\u043d\u044c"),b.default.createElement(F,{value:"2"},"\u041f\u0440\u0430\u0437\u0434\u043d\u0438\u0447\u043d\u044b\u0439 \u0434\u0435\u043d\u044c"))),b.default.createElement("div",{style:{display:f?"":"none"}},b.default.createElement("span",{style:p},(0,k.formatMessage)({id:"component.globalHeader.event"}),":"),b.default.createElement(s.default,{value:n.description,onChange:function(t){var a=t.target;e.setState(function(e){var t=e.modalForm;return{modalForm:(0,c.default)({},t,{description:a.value})}})},style:{width:"100%"},placeholder:(0,k.formatMessage)({id:"component.globalHeader.event"})}))),b.default.createElement(d.default,{bordered:!1},b.default.createElement(r.default,{tip:(0,k.formatMessage)({id:"system.loading"}),spinning:this.props.loadingData},b.default.createElement("div",null,b.default.createElement(S,{format:"MM.YYYY",value:l,onChange:this.onChangeDatePicker.bind(this),placeholder:(0,k.formatMessage)({id:"label.select"})}),b.default.createElement(o.default,{value:l,defaultValue:l,className:w.default.customCalendar,onSelect:this.onSelectDate.bind(this),dateCellRender:this.dateCellRender.bind(this)})))))}}]),t}(b.Component))||M);t.default=T}}]);